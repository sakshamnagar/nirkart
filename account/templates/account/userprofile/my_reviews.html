{% extends 'index.html' %}
{% load static %}

{% block css %}
{% endblock %}

{% block content%}

{% if user.is_authenticated %}

<div class="d-flex" style="min-height:70vh">

    <div class="d-flex flex-column flex-shrink-0 p-3 text-bg-dark" style="width: 280px;">
        <a href="{% url 'profile' %}" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" fill="currentColor" class="bi bi-person-square pe-none me-2" viewBox="0 0 16 16">
                <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
            <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1v-1c0-1-1-4-6-4s-6 3-6 4v1a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"/>
            </svg>
          <span class="fs-4">My Profile</span>
        </a>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto" style="width:100%;">
          <li class="nav-item" style="width:100%" onclick="editprofile()">
            <a href="{% url 'edit_profile' %}" class="nav-link text-white" aria-current="page">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-person-fill-gear pe-none me-2" viewBox="0 0 16 16">
                    <path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h5.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.544-3.393C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4m9.886-3.54c.18-.613 1.048-.613 1.229 0l.043.148a.64.64 0 0 0 .921.382l.136-.074c.561-.306 1.175.308.87.869l-.075.136a.64.64 0 0 0 .382.92l.149.045c.612.18.612 1.048 0 1.229l-.15.043a.64.64 0 0 0-.38.921l.074.136c.305.561-.309 1.175-.87.87l-.136-.075a.64.64 0 0 0-.92.382l-.045.149c-.18.612-1.048.612-1.229 0l-.043-.15a.64.64 0 0 0-.921-.38l-.136.074c-.561.305-1.175-.309-.87-.87l.075-.136a.64.64 0 0 0-.382-.92l-.148-.045c-.613-.18-.613-1.048 0-1.229l.148-.043a.64.64 0 0 0 .382-.921l-.074-.136c-.306-.561.308-1.175.869-.87l.136.075a.64.64 0 0 0 .92-.382l.045-.148ZM14 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0"/>
                </svg>
                Edit Profile
            </a>
          </li>
          <li class="nav-item" style="width:100%;" onclick="">
            <a href="{% url 'address' %}" class="nav-link text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-check pe-none me-2" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 8.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                    <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"/>
                    <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"/>
                </svg>
                Saved Addresses
            </a>
          </li>
          <li style="width:100%;">
            <a href="{% url 'my-order' %}" class="nav-link text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-check-fill pe-none me-2" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0m-.646 5.354a.5.5 0 0 0-.708-.708L7.5 10.793 6.354 9.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"/>
                  </svg>
                My Orders
            </a>
          </li>
          <li style="width:100%;">
            <a href="{% url 'my-reviews' %}" class="nav-link active">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hand-thumbs-up-fill pe-none me-2" viewBox="0 0 16 16">
                    <path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.816.533 2.511.062 4.51a9.84 9.84 0 0 1 .443-.051c.713-.065 1.669-.072 2.516.21.518.173.994.681 1.2 1.273.184.532.16 1.162-.234 1.733.058.119.103.242.138.363.077.27.113.567.113.856 0 .289-.036.586-.113.856-.039.135-.09.273-.16.404.169.387.107.819-.003 1.148a3.163 3.163 0 0 1-.488.901c.054.152.076.312.076.465 0 .305-.089.625-.253.912C13.1 15.522 12.437 16 11.5 16H8c-.605 0-1.07-.081-1.466-.218a4.82 4.82 0 0 1-.97-.484l-.048-.03c-.504-.307-.999-.609-2.068-.722C2.682 14.464 2 13.846 2 13V9c0-.85.685-1.432 1.357-1.615.849-.232 1.574-.787 2.132-1.41.56-.627.914-1.28 1.039-1.639.199-.575.356-1.539.428-2.59z"/>
                </svg>
                My Reviews
            </a>
          </li>
          <li style="width:100%;">
            <a href="#" class="nav-link text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-headset pe-none me-2" viewBox="0 0 16 16">
                    <path d="M8 1a5 5 0 0 0-5 5v1h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6a6 6 0 1 1 12 0v6a2.5 2.5 0 0 1-2.5 2.5H9.366a1 1 0 0 1-.866.5h-1a1 1 0 1 1 0-2h1a1 1 0 0 1 .866.5H11.5A1.5 1.5 0 0 0 13 12h-1a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h1V6a5 5 0 0 0-5-5"/>
                </svg>
                Customer Support
            </a>
          </li>
        </ul>
        <hr>
      </div>


      <div class="d-flex" style="min-height: max-content;">
        <div class="p-1 ms-2 flex-fill">
          <div class="px-0">
            <div><h3 class="text-primary text-muted m-4 mb-0">Pending Reviews:</h3></div>
            <div class="container mt-4 mb-4 px-0"> 
              
              <div class="container d-flex mt-4 px-0">
                    <div class="m-2 px-0">
                      {% if order %}
                      {% for order in order %}
 
                      <div class="card productdetails mb-5 ms-5">
                        {% if order.status == 'Order_Cancelled' %}
                        <a class="p-1" href="" style="background-color: orangered;">
                          <div class="pt-1 px-3 d-flex justify-content-between">
                            <p class="fs-6 font text-white">Status: {{order.status}}</p>
                            <p class="fs-6 font text-white">Order: ODR#{{order.order_id}}</p>
                          </div>
                          </a>
                        {% else %}  
                        <a class="p-1" href="" style="background-color: seagreen;">
                          <div class="pt-1 px-3 d-flex justify-content-between">
                            <p class="fs-6 font text-white">Status: {{order.status}}
                              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check2-circle" viewBox="0 0 16 16">
                                <path d="M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0"/>
                                <path d="M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l7-7z"/>
                              </svg>
                            </p>
                            <p class="fs-6 font text-white text14">Order Number: ODR#{{order.order_id}}</p>
                          </div>
                          </a>
                        {% endif %}
                        <div class="border-bottom-0"></div>
                        
                      <div class="modal-body p-2 pt-0">
                        
                        <div class="d-flex justify-content-between gap-4 align-items-center mt-2 p-2">
                          
                          <div><img style="height: 100px; width: 100px;" class="rounded-4" src="{{order.item_image}}" alt="{{order.item_name}}"></div>
                          <div class="fs-6 font text-primary fw-bold" style="width: 32vw;">{{order.item_name}} 
                            <br> 
                            <strong class="text18">₹{{order.item_discounted_price}}</strong>
                            {% if order.item_discount %}
                            <span class="text-decoration-line-through text-danger">₹{{order.item_price}}</span>
                            <span id="discountPrice">{{order.item_discount}}% OFF</span>
                            {% endif %}
                            <br>
                            <span class="text14 fw-bold text-muted">Quantity: {{order.item_quantity}}</span>
                          </div>
                            
                          <div class="grid-item">
                              <a class="btn btn-success mb-2 font d-flex align-items-center fw-bold text-muted" href="">
                                Contact Seller
                              </a>
  
                              <a class="btn d-flex align-items-center" style="background-color: orange;" href="{% url 'order:review' order.item_name %}">
                                <span class="ms-2 fw-bold text-muted">Rate Order</span>
                              </a>
                          </div> 
                        </div>                 
                      </div>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div><h5 class="text-primary text-muted m-4 mt-0 pt-0">No pending Reviews...</h5></div>
                    {% endif %}
                  </div>
              </div>         
            </div> 
          
<!--------->


<div class="pb-2 mt-1">
    <div class="container mt-4 mb-4">
      <div><h3 class="text-primary text-muted m-4 mb-4">My Reviews:</h3></div>
      <div class="d-block">
        {% for rev in review %}
            <div class="m-2">
              <div class="border border-black-1 rounded-4">
                <div class="border-bottom-0"></div>
              <div class="p-2 pt-0">
                
                    <div class="d-block p-3">
                      <div class="d-flex justify-content-between">
                        <p class="text18 text-primary">Item: {{rev.item.name}}</p>
                        <p class="text14 fw-bold text-muted">{{rev.created_at}}</p>
                      </div>
                      <div class="d-flex align-items-center gap-3">
                        {% if rev.rating == 4 or rev.rating == 5 %}
                          <p class="p-1 px-2 mt-1 rounded-2 fw-bold" id="discountPrice">{{rev.rating}} stars</p>
                        {% elif rev.rating == 3 %}
                        <p class="p-1 px-2 mt-1 rounded-2 bg-warning" id="userrating">{{rev.rating}} stars</p>  
                        {% else %}
                          <p class="p-1 px-2 mt-1 rounded-2" id="userrating">{{rev.rating}} stars</p>
                        {% endif %}
                      <div class="p-2 px-0">
                      <span id="star" class="gap-1 d-flex align-items-center justify-content-center" >
                        
                        {% with ''|center:rev.rating as range %}
                        {% for i in range %}
                        
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-star-fill star" id="rate" viewBox="0 0 16 16">
                          <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                        </svg>
                        {% endfor %}
                        {% endwith %}

                        {% with ''|center:rev.rating|add:-5 as range %}
                        {% for i in range %}
                        
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-star-fill" id="rate" viewBox="0 0 16 16">
                          <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                        </svg>
                        {% endfor %}
                        {% endwith %}
                    </span></div>
                    
                  </div>
                    <p class="text14 fw-bold text-muted mt-3">Comment:</p>
                    <p class="text14 fw-bold text-muted">{{rev.review}}</p>
                  </div>
              </div>
            </div>
          </div> 
        {% endfor %}
      </div>       
    </div>
  </div>

  </div>
</div>










{% endif %}
{% endblock %}